DBMS:
snowflake

Error:
net.snowflake.client.jdbc.SnowflakeSQLException: SQL compilation error: error line 3 at position 2
invalid identifier 'D.CALENDAR_YEAR'

SQL:
CREATE TEMP TABLE SCRATCH_LIKELLY_RWESNOW_SCHEMA.evmxrnafprevalence AS
SELECT
  d.calendar_year,
  d.age,
  d.gender_concept_id,
  SUM (case_event) AS numerator,
  COUNT(DISTINCT subject_id) AS denominator,
  (SUM(case_event) / COUNT(DISTINCT subject_id)) * 100000 AS prevalence_rate
FROM SCRATCH_LIKELLY_RWESNOW_SCHEMA.evmxrnafallEvents
GROUP BY d.calendar_year, d.age, d.gender_concept_id

R version:
R version 4.4.1 (2024-06-14)

Platform:
x86_64-pc-linux-gnu

Attached base packages:
- stats
- graphics
- grDevices
- utils
- datasets
- methods
- base

Other attached packages:
- DatabaseConnector (7.0.0)
- CohortPrevalence (0.0.0.9000)